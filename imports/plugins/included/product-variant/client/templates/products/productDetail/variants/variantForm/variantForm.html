<template name="variantForm">
{{#with variant}}
  <div id="variant-edit-form-{{_id}}" class="panel-group variant-edit-form {{variantFormVisible}}">
    <div class="panel panel-default variant-form">
      <div class="panel-heading panel-heading-flex">
        <div class="panel-title">
          {{#if inventoryManagement}}
            {{#unless isSoldOut }}
              <span class="variant-qty badge">{{displayQuantity}}</span>
            {{else}}
              {{#if inventoryPolicy }}
              <span class="variant-qty-sold-out badge">Sold Out!</span>
              {{ else }}
              <span class="variant-qty-sold-out badge">Backorder</span>
              {{/if}}
            {{/unless}}
          {{/if}}
          <span data-i18n="productDetailEdit.variantDetails">Variant Details</span>
          {{#if isDeleted}}
            <div class="panel-subheading">
              <span class="badge badge-danger" data-i18n="app.archived">
                <span>Archived</span>
              </span>
            </div>
          {{/if}}
        </div>
        <div class="panel-controls">
          {{> button
            icon="files-o"
            className="btn btn-default btn-clone-variant"
            tooltip="Duplicate"
            i18nTooltip="productDetailEdit.duplicateVariant"
          }}
          {{#if isDeleted}}
            {{> button
              icon="refresh"
              className="btn btn-default btn-restore-variant"
              tooltip="Restore"
              i18nTooltip="productDetailEdit.restoreVariant"
              onClick=(restoreVariant this)
            }}
          {{else}}
            {{> button
              icon="trash-o"
              className="btn btn-default btn-remove-variant"
              tooltip="Archive"
              i18nTooltip="productDetailEdit.removeVariant"
              onClick=(removeVariant this)
            }}
          {{/if}}
        </div>
      </div>
      <div class="panel-body">
        {{#autoForm
          schema=Schemas.ProductVariant
          doc=.
          type="method"
          meteormethod="products/updateVariant"
          id=variantFormId
          validation="keyup"
          resetOnSuccess=false
          autosave=true
        }}
        
        {{>afFieldInput name="_id" type="hidden"}}
        {{/autoForm}}
      </div> {{!-- END panel-body --}}
    </div>

    <div class="panel panel-default">
      <div class="panel-heading panel-heading-flex">
        <div class="panel-title">
          <span data-i18n="productDetailEdit.variantOptions">Variant Options</span>
        </div>
        <div class="panel-controls">
          {{> button
            icon="plus"
            className="btn btn-default btn-child-variant-form"
            tooltip="Add Option"
            i18nTooltip="productDetailEdit.addVariantOption"
          }}
        </div>
      </div>
      <div class="panel-group panel-group-accordian" role="tablist" aria-multiselectable="true">
        {{#each childVariants}}
          {{>childVariantForm}}
        {{/each}}
      </div>
    </div>
  </div>
{{/with}}
</template>
